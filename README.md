# Web-сервис для кредитного скоринга новых клиентов банка
## Обновление для v.2
- Разработана система экспериментирования и мониторинга обучения различных моделей (Optuna, MLFlow)
- Разработана база данных (PostgreSQL) для хранения информации о "старых" клиентах банка
- Внедрена система, по которой при наличии информации о клиенте в базе данных банка будет подобрана специальная модель прогнозирования.
- В ходе экспериментов были достигнуты следующие результаты:
    - Была обучена модель, которая на 6% повысила качество классификации для новых клиентов банка (с 61% AUROC до 67%)
    - Была обучена модель для "старых" клиентов банка, которая достигла качества классификации в 75% AUROC


## Бизнес-кейс
Наш банк запускает **новую программу кредитных карт с мгновенным одобрением**, низкими процентами по кредиту, многочисленными скидками и кэш-беком у магазинов-партнеров. При этом наш банк терпит убытки и **находится на грани кризиса**, поэтому важно отбирать клиентов с хорошей кредитной историей, которые **с малой вероятностью потерпят [дефолт](https://ru.wikipedia.org/wiki/%D0%94%D0%B5%D1%84%D0%BE%D0%BB%D1%82)**.

Для отбора клиентов была создана онлайн-анкета, где клиент вводит свои данные и система на их основе сделает вывод, стоит ли предоставлять данному клиенту услуги по новой программе, или стоит предложить ему более безопасные для банка варианты кредитных программ.

Для того, чтобы повысить конверсию анкеты, анкета была создана максимально простой и быстрой для заполнения.

Для потенциального повышения качества прогнозирования была заведена база данных клиентов банка, которая позволила при наличии информации о клиенте в базе данных подать системе прогнозирования дополнительные даные о клиенте

## Используемые технологии (и версии системы где они применяются)
- [Python](https://www.python.org/downloads/release/python-3120/) (v1, v2)
- [FastAPI](https://fastapi.tiangolo.com/) (v1, v2)
- [Scikit-Learn](https://scikit-learn.org/stable/) (v1, v2)
- [Streamlit](https://docs.streamlit.io/) (v1, v2)
- [PostgreSQL](https://www.postgresql.org/) (v2)
- [CatBoost](https://catboost.ai/) (v2)
- [XGBoost](https://xgboost.readthedocs.io/en/stable/) (v2)
- [LightGBM](https://lightgbm.readthedocs.io/en/stable/) (v2)
- [Optuna](https://optuna.org/#code_examples) (v2)
- [MLFlow](https://mlflow.org/docs/latest/ml/getting-started/) (v2)

## Результаты 
Был разработан веб-сервис, в котором клиент может указать свои данные и получить решение об одобрении ему новой кредитной программы

Нажмите на изображение ниже, чтобы перейти на **YouTube-видео**

[![Watch the video](https://img.youtube.com/vi/JcLgVuoKku0/0.jpg)](https://youtu.be/2lX4aBlDQ-E)

## Подробнее о модели предсказания 
В ходе экспериментирования с различными видами моделей и оптимизацией их параметров был отобран на основе модели [CatBoost](https://catboost.ai/). В ходе обучения был отдан приоритет метрике PR AUC, чтобы максимально понизить количество неправильно классифицированных клиентов, потерпящих дефолт, с учетом сильного дисбаланса данных (процент дефолтов в обучающей выборке составил 13%).

Для работы с новыми и старыми клиентами банка был обучен свой классификатор.

### Качество классификатора для новых клиентов
Качество нового классификатора по сравнению со старым было повышено с 61% AUROC до 67%
![new_client_auroc](assets/roc_auc_new_client.png)

### Качество классификатора для старых клиентов
Качество нового классификатора для старых клиентов достигло отметки в 75% AUROC
![old_client_auroc](assets/roc_auc_old_client.png)

## Дальнейшее развитие проекта
- Контейнеризировать и развернуть проект в облаке.
